<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>3D Configurator</title>
  <style>
    body,html{margin:0;padding:0;height:100%;overflow:hidden;font-family:sans-serif;}
    #container{display:flex;height:100%;}
    #slotsPanel,#objectsPanel{width:20%;background:#f4f4f4;overflow-y:auto;padding:10px;}
    #slotsPanel{border-right:1px solid #ccc;}
    #objectsPanel{border-left:1px solid #ccc;}
    #viewer{flex:1;position:relative;}
    canvas{display:block;}
    #bottomBtns{position:absolute;bottom:10px;left:50%;transform:translateX(-50%);}
    #bottomBtns button{margin:0 5px;}
    #transformBtns{position:absolute;top:10px;left:50%;transform:translateX(-50%);}
    #transformBtns button{margin:0 5px;}
    #objectActions{display:flex;gap:5px;margin-bottom:10px;}
    #objectModal{position:fixed;top:10%;left:50%;transform:translateX(-50%);display:none;z-index:10;}
    #objectModal .modal-box{background:white;border:1px solid #ccc;width:60vw;max-height:80vh;padding:20px;overflow:auto;position:relative;}
    #modalList{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px;max-height:60vh;overflow:auto;}
    #objectModal .modal-card{display:flex;flex-direction:column;gap:8px;cursor:pointer;}
    #objectModal .modal-card .thumb{position:relative;width:100%;padding-top:70%;border-radius:6px;overflow:hidden;background:#fff;}
    #objectModal .modal-card .thumb img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:contain;}
    #objectModal .modal-card .overlay{position:absolute;inset:0;pointer-events:none;background:rgba(0,0,0,0.06);}
    #objectModal .modal-card .overlay::after{content:'';position:absolute;inset:0;opacity:0;transition:opacity .2s;background:linear-gradient(180deg,rgba(0,0,0,0.1) 65.38%,rgba(2,2,2,0.6) 100%);}
    #objectModal .modal-card:hover .overlay::after{opacity:1;}
    #objectModal .modal-card .thumb p{position:absolute;bottom:5px;left:5px;color:#fff;font-weight:bold;font-size:16px;max-width:70%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;opacity:0;transition:opacity .2s;}
    #objectModal .modal-card:hover .thumb p{opacity:1;}
    #objectModal .modal-card .info{display:flex;justify-content:space-between;gap:8px;padding:0 4px;font-size:12px;}
    #objectModal .modal-card .info .owner{display:flex;align-items:center;gap:6px;flex:1;min-width:0;}
    #objectModal .modal-card .info .avatar{display:flex;align-items:center;justify-content:center;width:24px;height:24px;border-radius:50%;overflow:hidden;background:#ddd;flex-shrink:0;font-size:12px;font-weight:bold;color:#555;}
    #objectModal .modal-card .info .owner p{font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
    #objectModal .modal-card .info .counts{display:flex;gap:8px;flex-shrink:0;align-items:center;}
    #objectModal .modal-card .info .counts svg{width:16px;height:16px;fill:#777;}
    #objectModal .modal-card .info .counts p{margin-left:2px;font-size:11px;color:#777;}
    #objectModal .modal-card .info .counts .count{display:flex;align-items:center;}
    #objectModal .pagination{display:flex;justify-content:center;margin-top:10px;}
    #closeModal{display:block;margin:10px auto 0;}
    .slot{display:flex;align-items:center;justify-content:space-between;margin-bottom:5px;cursor:pointer;}
    .slot.selected{background:#ddd;}
    .slot button{margin-left:5px;}
    .obj-card{border:1px solid #ccc;padding:5px;margin-bottom:5px;}
    .obj-card.selected{background:#e0e0e0;}
    .material-list{display:flex;flex-wrap:wrap;}
    .material-list button{border:none;background:none;padding:0;margin:2px;cursor:pointer;}
    .material-list button.selected{outline:2px solid #00f;}
    .material-list img{width:40px;height:40px;object-fit:cover;}
  </style>
  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.165.0/build/three.module.js",
      "OrbitControls": "https://unpkg.com/three@0.165.0/examples/jsm/controls/OrbitControls.js",
      "GLTFLoader": "https://unpkg.com/three@0.165.0/examples/jsm/loaders/GLTFLoader.js",
      "TransformControls": "https://unpkg.com/three@0.165.0/examples/jsm/controls/TransformControls.js"
    }
  }
  </script>
</head>
<body>
  <div id="container">
    <div id="slotsPanel">
      <button id="addSlotBtn">Add slot</button>
      <ul id="slots"></ul>
    </div>
    <div id="viewer">
      <div id="transformBtns">
        <button id="moveBtn">Move</button>
        <button id="rotateBtn">Rotate</button>
        <button id="noneBtn">None</button>
      </div>
      <div id="bottomBtns">
        <button id="exportBtn">Export JSON</button>
        <button id="importBtn">Import JSON</button>
        <input type="file" id="importInput" accept="application/json" style="display:none" />
      </div>
    </div>
    <div id="objectsPanel">
      <div id="objectActions">
        <button id="addObjectBtn">Add object</button>
        <button id="inheritBtn">Inherit first</button>
      </div>
      <div id="objects"></div>
    </div>
  </div>
  <div id="objectModal">
    <div class="modal-box">
      <div id="modalList"></div>
      <div class="pagination">
        <button id="prevPage">Prev</button>
        <span id="pageInfo"></span>
        <button id="nextPage">Next</button>
      </div>
    </div>
    <button id="closeModal">Close</button>
  </div>
  <script type="module" src="./js/main.js"></script>
</body>
</html>
